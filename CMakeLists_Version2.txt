cmake_minimum_required(VERSION 3.20)
project(WatcherInjector LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
add_definitions(-DUNICODE -D_UNICODE -DNOMINMAX -DWIN32_LEAN_AND_MEAN)

include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src)

# Hook DLL
add_library(WatcherInjector SHARED
    src/WatcherInjector/WatcherInjector.cpp
)
target_compile_definitions(WatcherInjector PRIVATE _CRT_SECURE_NO_WARNINGS)
set_target_properties(WatcherInjector PROPERTIES
    OUTPUT_NAME "WatcherInjector"
    RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin"
    RUNTIME_OUTPUT_DIRECTORY_RELEASE "${CMAKE_BINARY_DIR}/bin"
)

# Injector EXE
add_executable(WatcherInjectorExe
    src/WatcherInjectorExe/WatcherInjectorExe.cpp
)
target_link_libraries(WatcherInjectorExe PRIVATE user32)
set_target_properties(WatcherInjectorExe PROPERTIES
    OUTPUT_NAME "WatcherInjector"
    RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin"
    RUNTIME_OUTPUT_DIRECTORY_RELEASE "${CMAKE_BINARY_DIR}/bin"
)